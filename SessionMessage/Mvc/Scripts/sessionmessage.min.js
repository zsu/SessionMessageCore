function displayMessages(){var n=$("#messagewrapper"),t=$("#messageboxstatusbar"),i=$("#messageboxmodal"),r;n.children().length>0?(t&&t.children().length>0&&(typeof toastr!="undefined"?(t.hide(),t.children().each(function(){var n=$(this).attr("caption"),t=$(this).html();switch($(this).attr("type")){case"Success":toastr.success(t,n);break;case"Error":toastr.error(t,n);break;case"Warning":toastr.warning(t,n);break;case"Info":toastr.info(t,n)}$(this).remove()})):(n.mouseenter(function(){r&&(clearTimeout(r),n.stop(!0).css("opacity",1).show())}).mouseleave(function(){r=setTimeout(function(){n.slideUp("slow")},5e3)}),n.show(),r=setTimeout(function(){n.slideUp("slow");clearMessages()},5e3),$(document).click(function(){clearMessages()}))),i&&i.children().length>0&&(i.dialog({bgiframe:!0,autoOpen:!1,modal:!0,title:"Message",close:function(){try{return $(this).dialog("destroy").remove(),clearMessages(),!0}catch(n){return!0}}}),i.dialog("open"),n.show())):n.hide()}function clearMessages(){$("#messagewrapper").fadeOut(500,function(){$("#messagewrapper").empty()})}function handleAjaxMessages(){$(document).ajaxSuccess(function(n,t){if(t.getResponseHeader("FORCE_REDIRECT")!==null){window.location=t.getResponseHeader("FORCE_REDIRECT");return}checkAndHandleMessageFromHeader(t)})}function checkAndHandleMessageFromHeader(n){var t=n.getResponseHeader("X-Message");t&&displayMessage(t);t=n.getResponseHeader("X-ModalMessage");t&&displayModalMessage(t)}function displayMessage(n){var i=JSON.parse(n),t,r;i&&(clearMessages(),jQuery("<div/>",{id:"messageboxstatusbar","class":"messagebox"}).appendTo("#messagewrapper"),t=$("#messageboxstatusbar"),r=!1,$.each(i,function(n,i){if(t&&t.children().length>0&&i.Key&&t.children("div[key="+i.Key+"]").length!=0)return!0;jQuery("<div/>",{"class":"messagebox "+i.Type,text:i.Message,key:i.Key,type:i.Type,caption:i.Caption}).appendTo("#messageboxstatusbar")}),displayMessages())}function displayModalMessage(n){var i=JSON.parse(n),t,r;i&&(jQuery("<div/>",{id:"messageboxmodal","class":"messagebox"}).appendTo("#messagewrapper"),t=$("#messageboxmodal"),r=!1,$.each(i,function(n,i){if(t&&t.children().length>0&&i.Key&&t.children("div[key="+i.Key+"]").length!=0)return!0;jQuery("<div/>",{"class":"messagebox "+i.Type.toLowerCase(),text:i.Message,key:i.Key}).appendTo("#messageboxmodal")}),displayMessages())}$().ready(function(){handleAjaxMessages();displayMessages()});